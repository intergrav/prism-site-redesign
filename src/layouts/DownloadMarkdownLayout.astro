---
import MainLayout from "./MainLayout.astro";
import PlatformSwitcher from "../components/PlatformSwitcher.astro";
import Card from "../components/ui/Card.astro";
import ProseCard from "../components/ui/ProseCard.astro";
import DownloadCard from "../components/ui/DownloadCard.astro";
import { DOWNLOADS } from "../data/downloads";

export interface Props {
	frontmatter: {
		title: string;
		platform: string;
		description?: string;
		screenshotLight?: string;
		screenshotDark?: string;
		screenshotAlt?: string;
	};
}

const {
	frontmatter: {
		title,
		platform,
		description,
		screenshotLight,
		screenshotDark,
		screenshotAlt,
	},
} = Astro.props;
---

<MainLayout title={title} description={description}>
	<Card>
		<PlatformSwitcher currentPlatform={platform} />
		<h1 class="heading-1 mb-6">{title}</h1>

		<div class="flex flex-col gap-6">
			<div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
				{
					(DOWNLOADS[platform as keyof typeof DOWNLOADS] || []).map(
						(section) => (
							<DownloadCard
								title={section.title}
								downloads={section.downloads}
							/>
						),
					)
				}
			</div>

			{
				screenshotLight && screenshotDark && (
					<div class="flex justify-center">
						<picture>
							<source
								media="(prefers-color-scheme: dark)"
								srcset={screenshotDark}
							/>
							<img
								src={screenshotLight}
								alt={
									screenshotAlt || `Prism Launcher screenshot on ${platform}`
								}
							/>
						</picture>
					</div>
				)
			}
		</div>
	</Card>

	<!-- markdown content goes here -->
	<ProseCard>
		<slot />
	</ProseCard>
</MainLayout>
